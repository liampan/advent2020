val testInput = "..##.......\n#...#...#..\n.#....#..#.\n..#.#...#.#\n.#...##..#.\n..#.##.....\n.#.#.#....#\n.#........#\n#.##...#...\n#...##....#\n.#..#...#.#"
  .split("\n")
  .toList

val realInput = "........#..#.##.#..............\n...#...............#.#.........\n...#..#...#..##....#...........\n...#.............#....#.....#..\n..#......#..#...#.......#......\n..............##...............\n#.......#.........#......#....#\n.#.....###.....#...#.#.#...#...\n#.....................#....#.#.\n.......#...................#...\n...#.#...................#....#\n....#....#.......#...#.........\n..##.#............#..#.........\n.....##.#..............##..###.\n...........#....#....#.........\n#.....#...#...#.#.#.#.##.#...#.\n.#...............#....##.......\n.....#..#......#....#.......##.\n.....#........#.......#........\n...#...##...#..##...#.....##...\n.....#.........#.###...##...#..\n.#.##...#........#.#.#.#....#..\n....#......##.#...#.....#....#.\n.......###..........#..#..#....\n......#...#.##.................\n....#...#...#.........#......#.\n.....#...........#...###....#..\n.....#...#.#.#....##.#......#.#\n......#...#.....#..#..#........\n#......#..#...##........###....\n##.....#....##..#.#.###.#...#..\n........#....#.......#.....#..#\n#.#.#.##.#.#...................\n..#...##....#......#.....##....\n.......#.##..#........##..#....\n.#.#....##......#.#..........#.\n#..............#............#..\n.#.#.#.#.#.####.#.#...##.......\n.#..#.....##.#.......#.##...#..\n..#.#........#.............#.#.\n..#.#..........#..#........#...\n..#..#...#.......##...#.#....##\n...#.....#.#.#.....#....#....#.\n.#...#......#.....#..##........\n...#.......##.#.#.....#......#.\n...........#.....#.#.......#...\n#...........#...#..#.#........#\n....#......#..##........#..###.\n.#..#........................#.\n#.......#......#...#...#..#....\n....#.#...#..#.#....#....##.#..\n.....#......#..#..........##.#.\n.#.....#...........#.........#.\n...###.#...#.......#.#.........\n.......#....#..........#..#...#\n......##..#.......#...##.......\n..#..........#.......#.........\n..........#..#..#..#..#........\n.#.................####...#.#.#\n..##.....#............#........\n....#.....###...#......#....#.#\n...##.#...........#.##......#..\n#..##..#..#....#...#..#........\n......#....#........#.......#..\n......#.....#......###.........\n.#.....#.#......#.......#......\n..#.........#..#..#........##.#\n..#.#....#.....#....##....#.#..\n...#.............##............\n........#..#..#......#...#.....\n.....#.#...#...##.....#.....#..\n.#..#.#..........##...##.....#.\n......##.#..........#...#.....#\n#.#.##......#....#..........#..\n................#.......#.##...\n#.......#.....#.......#....#...\n#..#.....#.##..##...........#..\n.....#....#.#.##..........#..##\n#.......#.....#.##...........#.\n........#.##........###..#.#...\n........#..................#...\n#.........................#...#\n....#.........#...#.#..#.....#.\n.#............#....#...........\n..#.#...#..##...#.#.......#....\n.#.#....#...........#.........#\n...#.#..........#.....#...#....\n......#....#.#...............##\n....##......###...##.##.....##.\n............#.#....#.#.....#..#\n.....#..#.....#.#...###....#...\n.......##....##..#...##..#...##\n.....#.......##..#...#...#....#\n#.........##....#........###.#.\n...#..##...#...#.........#.#.#.\n....#.#.....#.....#............\n#........#....#..#........#....\n.......#....#...#..............\n#...#.........##.....###.#.....\n.#....##..#...#..##.........#..\n....#.....#......##..#..#....#.\n#.#..#.........#........#......\n..#.......#.........#.....###..\n..#..........#...........#....#\n..#...............#......#..#..\n....#..#...#....###.....#..#..#\n#...#...#..#...........#....#..\n.#....#.#..#....#.#...........#\n.....#.....#..#....#..#....#...\n#.#..#...........#.#...........\n..................#.#.......#..\n...#.........#.....#..##....#..\n.........#.#...#.........##....\n...#..#....#.....#...#..#......\n.#.##.....#....#....#......##..\n##..#.........#.#....#...#.....\n#......#.#...#....#.#..#.......\n.......#.....#.....###....#.#..\n.#....##.#.....#...#.......#...\n.#.......#..#...#......#..#..##\n...............#...#...........\n#..............#....#.#.#....#.\n...........#..#.......#.##..#..\n..#......#.#....#...#.#.....#..\n#..............................\n#..#....#..........#...#.......\n......#.............#####......\n.#...###......#.#.#.##..#......\n............#.##.....#.........\n.........#....##....#..........\n###....#......#.......#........\n.#.......##..........#..#....#.\n#..#.....................#....#\n........#...........#..........\n..#..........#...#..#.........#\n..#..#......##................#\n.....##..#...#..#..............\n.......#...##..#...............\n.......##..#.####....#....#.#..\n#.#..#..........#........##....\n....##....#.#..#....#.#...#....\n......#.......#...#.....#...#..\n..#..#...#.....#.......###.....\n...#.......#.#.#.......#.##....\n...............#..#.#........#.\n.#....###.#......#.............\n.#..#...#....#.#..#.....#......\n.......#.##....#.#.##.##...#.#.\n..#...#....#.#..##.#.....#...##\n..#...#......#...#......#...#..\n....#..#...#.#..#......#.......\n#..#...............#......#.##.\n.#....#...#..........#.#.....#.\n.#..#.#.#................#..#..\n.#....#.#...#..##.###..#...###.\n#.............#.....#.........#\n...#.........#...#.......#..#..\n......#..#.........#..........#\n........##................#..#.\n......#...#.#.....#......##....\n...............#...#....#......\n...#.#..#..#.....##.###..##..#.\n.#....##......#...#..##..#.....\n.....#.........##.##....#...#..\n.....#.#..................####.\n#.....#...#.............##....#\n#.#..........#...#..#..#.......\n#..#.#.........#...............\n....#...#.........#...##.......\n...........#.....#..##..#......\n#.....#.......#.#........#.....\n..##..#.....#...##......#......\n....#....#.....................\n............#......#.........##\n.....##.............#.....##..#\n.......#.............#..#.#.##.\n.###...#......#..#........##.#.\n..#.#...#.#....#.....#..#......\n..#.#..#.##........#...#.......\n........#.#...............#..#.\n........##.......#...#.......#.\n...#........##.#..........#.#.#\n..#..###.#.#.......#.#......#..\n....#..........#...#..#........\n...#..#...#...#.#....#...#..#..\n...#...#........#......##...#.#\n#...........#..........#..#.##.\n...#..##..................#.#..\n...##.#...#....#.#...#.####....\n.....#...#.#.#..#..............\n.....#..#.#.#..#...............\n..#..#..##...#.#..#.....##....#\n.......#.#..#.....#....#.......\n...#..#....#.........#...#.....\n..............#.#...#...##.....\n...................#...........\n.#......#.#...................#\n.##.....#........#.........#..#\n.##..##...#...................#\n...#....#.#..#.#.#..#.....##...\n.......#..#....#......####.#...\n.##..#..##....#.......#........\n.#...#...........##............\n.....#.....#........#..........\n....##..#....#.....#...........\n.#...#....................#....\n....#.........#.......##.....#.\n.#....#..#.....#.##....#.......\n....#..#.........#.#....#.#....\n.......#.........##....#.......\n..#......#....#....#...#.......\n........#..#.......#.##......#.\n..#.....#......#...#..#.......#\n#..#.....##...#...#............\n.......##.......#........#...#.\n..#......................#...#.\n....##.#.............#......#..\n#.#............................\n...##.#.....#.#............#.##\n......#...#..#.........##......\n.#.......#.....##.......#.#....\n...........#.#.........#..##...\n...#..........#.##....#........\n........#..#..#...#....#....#..\n........##....#.#....#........#\n..#........##....###....#......\n#................###...#...#...\n................#.#..###......#\n..#.....##.#................#..\n.....#...............#..#......\n..#.......####.....#..#.#....##\n..#.....#..#....#..............\n#.#...........#.#.....#..##....\n#.#..........#.......#...#.###.\n........#....#...#..#.#........\n.#.....#......#..#..#..###..#..\n.#.........#.##.#.#......##....\n..#.........#...##..#........#.\n.#...................#.........\n...#.#........#................\n............#.....#..##........\n..#.....#.#......#.......#...#.\n........#....##..##...#.....##.\n.#........#.#....#.#....#.#..#.\n#.#.......#....................\n.#..#...##.........#..#........\n.........#...............#.....\n...#...#.....#......#.......#..\n###......................#.#..#\n...#.....####........#..#.....#\n#.#...#.#...................##.\n.........#.....................\n#..........##..#.....#....#....\n.......#...#.#.##.#..##........\n..........#..#.#..#.#.......#.#\n.....................#.#...#...\n...........#.#........#.#.#....\n.......#......#........#...#.#.\n.........#....................#\n.##.##....#...#.#.#.#..........\n#....##..#.##....#....#.......#\n.##.#...#...............#....#.\n.......#...#.###....#..........\n.....#....#...#..#.............\n#.........#.##....#.#.#........\n..#...#.............##..#..#...\n#..##.......#..........#...#.#.\n.#..#.....#...........#......#.\n......#......#..............##.\n.#...#..#...#..####.....#.....#\n....##.......#..........##.....\n.#.....#.......#.....#.#...#...\n..#..#..#.#...#......#.........\n......#.#....#........#.......#\n........#.......#..............\n..#...#.#....#........#.......#\n............#....#...##.#......\n.........#.............#..#....\n#.............#.#..##.......#..\n#....#...........###....#......\n...#.....................#.....\n....#.#..........#...#.......#.\n......#..#.......#...#...#....#\n.#.#..#.....##.#........#......\n...........#...#.#.............\n...###............#...#..#.....\n..#.#.......#...#.#..#.........\n.#......##...........#.....#.##\n.....##.....#....##...##.#.#...\n..........#.#.#......#........#\n..#.#........#....##....#.#....\n.#....#...##...........#....#..\n##......#...#.......#..........\n.##...###..#...#......#..##.#.#\n...........##.#..##...#.......#\n..#..............##............\n........#..#........#...#..#.#.\n..#.............#......#...##..\n#...##....#...#....#....#.#....\n.#.#......#..##............#.#.\n.....###.#....##....#....#.....\n#.#.#..........#...#...#.#.#...\n.....#.#...........####........\n.....#....##...#.##..#......#..\n#....#.......#.##.......#..#...\n.....#.....#........#..........\n.......#.......#...#.##......#.\n...#.........##...#.#.#......##\n#........#........#...#..#.....\n.#......#.#......#.#...#....#..\n#..#....##.....##..............\n...#.##............#..........#\n.....#.#....#..#.#............#\n..#......#...###.##.......###..\n........#....#.#.#.#...........\n............#..#........#.....#\n....#...............#..........\n......#....#....###..#.......##\n#...#...##....#.........#...#..\n...........#.#.............#...\n...#..#.....#..##.#....#......#\n..#...#..#...#......#..........\n....#..#....#.......#........#."
  .split("\n")
  .toList

def hitTree(line:  String, across: Int): Boolean = {
  val ll = line.length
  val replaceWith: String = if (line(across % ll) == '#') "X" else "O"
  println(line.splitAt(across)._1 + replaceWith + line.splitAt(across)._2.drop(1))
  line(across % ll) == '#'
}

case class Route(right: Int, down: Int)

def ski(skiMap: List[String], route: Route): Int = {
  skiMap
    .zipWithIndex
    .collect{case (line, index) if index%route.down == 0 => line}
    .zipWithIndex
    .count(a => hitTree(a._1, a._2*route.right))
}

ski(testInput, Route(1, 2))

List((1,1),(3,1),(5,1),(7,1),(1,2)).map{case (r, d) => ski(realInput, Route(r, d))}.product

